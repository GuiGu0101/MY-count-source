define("app/components/DoGroup/index.jsx",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(e,t,n){for(var r=!0;r;){var a=e,o=t,l=n;r=!1,null===a&&(a=Function.prototype);var u=Object.getOwnPropertyDescriptor(a,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(l)}var i=Object.getPrototypeOf(a);if(null===i)return void 0;e=i,t=o,n=l,r=!0,u=i=void 0}},c=e("node_modules/react/react"),f=a(c),p=e("node_modules/react-addons-pure-render-mixin/index"),h=a(p),m=e("app/components/react-qtui/index"),g=e("app/components/Dialog/index.jsx"),y=e("app/actions/CallBack/group.jsx"),v=r(y),b=function(e){function t(e,n){l(this,t),d(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n),this.addFiled={inputChange:function(e){this.setState({addUserData:s({},this.state.addUserData,{name:e.target.value,errMsg:""})})},buttons:[{type:"default",label:"结束",onClick:this.hideDialog.bind(this)},{type:"primary",label:"下一个",onClick:this.doAddFiled.bind(this)}]},this.shouldComponentUpdate=h["default"].shouldComponentUpdate.bind(this),this.state={type:"",color:"#333",typeName:"",user:[],addUserData:{name:"",errMsg:"",isInner:!1},group:"1"}}return u(t,e),i(t,[{key:"componentWillMount",value:function(){this.state.type=this.props.type,"land"===this.props.type?(this.state.typeName="陆地活动",this.state.color="#a76c0a"):(this.state.typeName="水上活动",this.state.color="#00ACDC")}},{key:"componentDidMount",value:function(){}},{key:"hideDialog",value:function(){console.log("hide"),this.setState({showAddFiled:!1,addUserData:{name:"",errMsg:""},errorMsgs:[]})}},{key:"doAddFiled",value:function(){var e=this,t=this.state,n=t.addUserData,r=t.user;""===n.name?this.setState({addUserData:s({},this.state.addUserData,{errMsg:"编号不能为空"})},function(){return e.refs.dialogInput.focus()}):-1===r.indexOf(n.name)?(r.push(n.name),this.setState({addUserData:{name:"",errMsg:""},user:[].concat(o(r))},function(){return e.refs.dialogInput.focus()})):this.setState({addUserData:s({},this.state.addUserData,{errMsg:"编号已存在"})},function(){return e.refs.dialogInput.focus()})}},{key:"submit",value:function(){var e=this,t=this.state,n=t.group,r=t.user,a=t.type;v.doGroup({type:a,group:n,users:r}).then(function(e){return"function"==typeof e.json?e.json():e}).then(function(t){if(console.log(t),1!==t.status)alert(t.message?t.message:"分组失败，请重试");else{var n="以下魅友已被编入"+("water"===t.type?"水上":"陆地")+"第"+t.group+"组：\r\n"+t.user.join(",");t.nu_user.length>0&&(n+="\r\n以下魅友已被分配在其他组：\r\n"+t.nu_user.join(",")),t.no_sign.length>0&&(n+="\r\n以下魅友还未签到：\r\n"+t.no_sign.join(",")),alert(n),e.setState({user:[]})}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.typeName,r=t.color,a=t.user,o=t.addUserData,l=t.showAddFiled;return f["default"].createElement("div",null,f["default"].createElement("div",{style:{textAlign:"center",color:r,fontSize:"24px"}},n),f["default"].createElement(m.CellsTitle,null,"组别"),f["default"].createElement(m.Form,null,f["default"].createElement(m.FormCell,{select:!0,selectPos:"after"},f["default"].createElement(m.CellBody,null,f["default"].createElement(m.Select,{onChange:function(t){return e.setState({group:t.target.value})}},f["default"].createElement("option",{value:"1"},"第一组"),f["default"].createElement("option",{value:"2"},"第二组"),f["default"].createElement("option",{value:"3"},"第三组"),f["default"].createElement("option",{value:"4"},"第四组"))))),f["default"].createElement(m.CellsTitle,null,"成员名单"),f["default"].createElement(m.Cells,null,a.map(function(e,t){return f["default"].createElement(m.Cell,{key:t},f["default"].createElement(m.CellBody,null,e))})),f["default"].createElement(m.ButtonArea,null,f["default"].createElement(m.Button,{type:"default",onClick:function(){return e.setState({showAddFiled:!0},function(){return e.refs.dialogInput.focus()})}},"添加成员"),f["default"].createElement(m.Button,{onClick:this.submit.bind(this)},"确认分组")),f["default"].createElement(g.Dialog,{title:"输入魅友编号",show:l,buttons:this.addFiled.buttons},f["default"].createElement(g.DialogInput,{ref:"dialogInput",placeholder:"编号，例如01",defaultValue:o.name,warn:!!o.errMsg,type:"number",desc:o.errMsg,onChange:this.addFiled.inputChange.bind(this)})))}}]),t}(c.Component);t["default"]=b,n.exports=t["default"]});